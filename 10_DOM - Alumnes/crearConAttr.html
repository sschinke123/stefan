<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../02_uso_frameworks/w3/source/css/w3.css" />
    <title>Document</title>
  </head>

  <body>
    <main class="w3-container">
      <h2>Crear elementos con el DOM</h2>
      <p>posicion:</p>
      <input type="number" id="posicion" />
      <p>texto:</p>
      <input type="text" id="valor" />

      <input id="crear" type="button" value="Crear" />
      <div id="contenedorPadre"></div>
    </main>
    <!-- <script>
      const posicion = document.querySelector("#posicion");
      const texto = document.querySelector("#valor");
      const padre = document.querySelector("#contenedorPadre");

      const creaParrafos = () => {
        let pos = posicion.value;
        let text = texto.value;
        let hijos = padre.children.length;

        let elementoNodo = document.createElement("p");
        let nodoTexto = document.createTextNode(text);
        let id = hijos + 1;
        elementoNodo.appendChild(nodoTexto);
        elementoNodo.setAttribute("id", id);

        if (hijos === 0 && text !== "") {
          padre.appendChild(elementoNodo);
        } else if (text === "") {
          alert("introduce un texto.");
          texto.focus();
        } else {
          if (pos) {
            if (pos <= hijos) {
              for (i = 0; i < hijos; i++) {
                if (i === pos + 1) {
                  let actual = document.querySelector(padre.children[i]);
                  padre.insertBefore(elementoNodo, actual);
                }
              }
            } else if (parseInt(parseInt(pos) - hijos) <= 1) {
              padre.appendChild(elementoNodo);
            }
          } else {
            alert("Introduce la posicion");
            posicion.focus();
          }
        }
      };

      let crear = document.querySelector("#crear");
      crear.addEventListener("click", creaParrafos);
    </script> -->
    <script>
      const posicion = document.querySelector("#posicion");
      const texto = document.querySelector("#valor");
      const padre = document.querySelector("#contenedorPadre");

      const creaParrafos = () => {
        // Cambié el nombre de la función a 'creaParrafos'
        let pos = posicion.value;
        let text = texto.value;
        let hijos = padre.children.length;

        let elementoNodo = document.createElement("p");
        let nodoTexto = document.createTextNode(text);
        let id = hijos + 1;
        elementoNodo.appendChild(nodoTexto);
        elementoNodo.setAttribute("id", id);

        if (hijos === 0 && text !== "") {
          padre.appendChild(elementoNodo);
        } else if (text === "") {
          alert("Introduce un texto.");
          texto.focus();
        } else {
          if (pos) {
            pos = parseInt(pos); // Aseguramos que la posición sea un número
            if (pos <= hijos && pos > 0) {
              let actual = padre.children[pos - 1]; // Aquí pos - 1 porque las posiciones en el array empiezan en 0
              padre.insertBefore(elementoNodo, actual);
            } else if (pos === hijos + 1) {
              padre.appendChild(elementoNodo); // Añadir al final
            } else {
              alert("Posición no válida.");
            }
          } else {
            alert("Introduce la posición");
            posicion.focus();
          }
        }
      };

      let crear = document.querySelector("#crear");
      crear.addEventListener("click", creaParrafos); // Cambié el nombre del evento a 'creaParrafos'
    </script>
  </body>
</html>
